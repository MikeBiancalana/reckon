{"id":"reckon-0e5","title":"Create TaskRepository for DB operations","description":"Create repository for task database operations.\n\n## File to Create\n\n`internal/journal/task_repository.go`\n\n## Methods to Implement\n\n```go\ntype TaskRepository struct {\n    db *sql.DB\n}\n\nfunc NewTaskRepository(db *sql.DB) *TaskRepository\n\n// SaveTask saves a task and its notes to the database\nfunc (r *TaskRepository) SaveTask(task *Task) error\n\n// SaveTasks saves multiple tasks (bulk operation)\nfunc (r *TaskRepository) SaveTasks(tasks []Task) error\n\n// GetAllTasks retrieves all tasks with their notes\nfunc (r *TaskRepository) GetAllTasks() ([]Task, error)\n\n// GetTaskByID retrieves a single task by ID\nfunc (r *TaskRepository) GetTaskByID(id string) (*Task, error)\n\n// DeleteTask deletes a task and its notes\nfunc (r *TaskRepository) DeleteTask(id string) error\n\n// DeleteTaskNote deletes a specific note\nfunc (r *TaskRepository) DeleteTaskNote(noteID string) error\n```\n\n## Implementation Details\n\n- Use transactions for operations affecting multiple tables\n- When saving task, also save/update notes\n- When loading tasks, join with task_notes and populate Notes slice\n- Sort notes by position when loading\n- Follow existing repository patterns from `internal/journal/repository.go`\n- Use prepared statements where appropriate\n\n## SQL Operations\n\n- INSERT/UPDATE tasks table\n- INSERT/UPDATE task_notes table (with task_id FK)\n- SELECT with JOIN for loading tasks with notes\n- DELETE with CASCADE for task removal\n\n## Acceptance Criteria\n\n- SaveTask persists task and all notes\n- GetAllTasks returns tasks with notes properly nested\n- GetTaskByID returns single task with notes\n- DeleteTask removes task and cascades to notes\n- DeleteTaskNote removes specific note\n- Transactions used for multi-table operations\n\n## Dependencies\n\nRequires: Task/TaskNote models and DB schema\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 2, Step 3.1)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:46:28.690148201-05:00","updated_at":"2025-12-23T19:46:28.690148201-05:00","dependencies":[{"issue_id":"reckon-0e5","depends_on_id":"reckon-e0f","type":"blocks","created_at":"2025-12-23T19:49:41.579731137-05:00","created_by":"daemon"}]}
{"id":"reckon-1l8","title":"Phase 3: Time Tracking","description":"Track time spent on meetings, breaks, and optionally tasks. Calculate daily time summaries.\n\n**Requires Phase 2**: Uses task infrastructure for task-level time tracking.\n\n**Time Entry Formats** (in log):\n```\n- 10:30 [meeting:standup] 30m       # meeting with duration\n- 12:00 [break] 45m                  # break with duration\n- 14:00 [task:abc123] Started work   # task entry (duration calculated from next entry or end of day)\n```\n\n**Features to Implement**:\n\n1. **Duration Parsing**\n   - Extend log entry parser to extract Xm or Xh duration\n   - Store in duration_minutes field\n\n2. **Time Calculation Service** (internal/time/)\n   - CalculateDaySummary(date): aggregate time by category\n   - For tasks without explicit duration, calculate from timestamps\n   - Categories: meetings, breaks, tasks (by task), untracked\n\n3. **Daily Summary Component** (internal/tui/components/summary.go)\n   - Shows time breakdown at bottom of journal view\n   - Toggle with 's' key\n   - Format: \"Meetings: 1h30m | Tasks: 4h15m | Breaks: 45m | Untracked: 1h30m\"\n\n4. **Optional Start/Stop Timer**\n   - rk start \u003ctask-id\u003e - log \"Started work on [task]\"\n   - rk stop - log \"Stopped\" (duration auto-calculated)\n   - TUI: Ctrl+S to start/stop timer on current task\n\n5. **CLI Commands**:\n   - rk summary - output today's time breakdown\n   - rk summary --week - output week's time breakdown\n   - rk start \u003ctask-id\u003e - start timer on task\n   - rk stop - stop current timer\n\n**Acceptance Criteria**:\n- Log entries with 30m duration are parsed and stored\n- [meeting:name] Xm entries are categorized as meetings\n- [break] Xm entries are categorized as breaks\n- rk summary outputs time breakdown for today\n- TUI shows time summary (toggle with 's')\n- Task time calculated from log entry timestamps\n- Start/stop timer commands work","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-22T16:48:37.245472509-05:00","updated_at":"2025-12-22T16:48:37.245472509-05:00","dependencies":[{"issue_id":"reckon-1l8","depends_on_id":"reckon-9cn","type":"blocks","created_at":"2025-12-22T16:49:06.430378979-05:00","created_by":"daemon"}]}
{"id":"reckon-2a9","title":"TUI: Show current date in UI","description":"User can navigate between dates with h/l keys but has no visual confirmation of what date they're viewing.\n\nCurrent state is tracked in m.currentDate but not displayed anywhere.\n\nShould show current date in:\n- Option 1: Status bar (bottom)\n- Option 2: Title area (top)\n- Option 3: Both\n\nConsider also showing if it's 'Today' vs the actual date.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T18:53:12.522004806-05:00","updated_at":"2025-12-22T19:49:41.09159723-05:00","closed_at":"2025-12-22T19:49:41.09159723-05:00","close_reason":"Implemented date display in TUI status bar. Shows 'Today' or formatted date (Mon, Jan 2, 2006) with smart spacing alongside keyboard hints."}
{"id":"reckon-3e9","title":"Phase 1.10: Implement file watcher for external changes","description":"Implement file watching using fsnotify to detect external changes to journal files.\n\n**Features**:\n- Watch ~/.reckon/journal/ directory\n- Debounce changes (100ms)\n- Re-index changed files to SQLite\n- Notify TUI to reload if current journal changed\n\n**Files**:\n- internal/sync/watcher.go\n- Integration with TUI model for live reload","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-22T17:17:32.866318663-05:00","updated_at":"2025-12-22T17:17:32.866318663-05:00"}
{"id":"reckon-40n","title":"Redesign TUI model for new layout and components","description":"Redesign main TUI model to support 40-40-18 layout with new components.\n\n## File to Modify\n\n`internal/tui/model.go`\n\n## Struct Changes\n\n**Add fields:**\n```go\ntaskService  *journal.TaskService\ntaskList     *components.TaskList\nscheduleView *components.ScheduleView\ntextEntryBar *components.TextEntryBar\ntasks        []journal.Task  // cached tasks\n```\n\n**Remove fields:**\n```go\ninputMode    bool   // REMOVE - replaced by text entry bar focus\ninputType    string // REMOVE - replaced by text entry bar mode\ntextInput    textinput.Model // REMOVE - replaced by text entry bar\n```\n\n**Modify Section enum (add):**\n```go\nSectionTasks    Section = 3\nSectionSchedule Section = 4\n```\n\n## Init() Changes\n\n- Load tasks: Add `loadTasks()` tea.Cmd\n- Initialize text entry bar: `textEntryBar: components.NewTextEntryBar()`\n\n## View() Rewrite\n\n```go\nfunc (m *Model) View() string {\n    // Calculate dimensions\n    dims := layout.CalculatePaneDimensions(m.width, m.height)\n    \n    // Get pane views\n    logsView := m.logView.View()  // existing\n    tasksView := m.taskList.View()  // NEW\n    \n    // Stack right sidebar\n    m.scheduleView.SetSize(dims.RightWidth, dims.ScheduleHeight)\n    m.intentionList.SetSize(dims.RightWidth, dims.IntentionsHeight)\n    m.winsView.SetSize(dims.RightWidth, dims.WinsHeight)\n    \n    rightSidebar := lipgloss.JoinVertical(\n        lipgloss.Top,\n        m.scheduleView.View(),\n        m.intentionList.View(),\n        m.winsView.View(),\n    )\n    \n    // Join main panes horizontally\n    borderStyle := lipgloss.NewStyle().BorderRight(true)\n    content := lipgloss.JoinHorizontal(\n        lipgloss.Top,\n        borderStyle.Render(logsView),\n        borderStyle.Render(tasksView),\n        rightSidebar,\n    )\n    \n    // Add text entry bar\n    textEntry := m.textEntryBar.View()\n    \n    // Add status bar\n    status := m.statusBar.View()\n    \n    return content + \"\\n\" + textEntry + \"\\n\" + status\n}\n```\n\n## Update() Changes\n\n**Remove input mode handling** (lines 132-148)\n\n**Add keyboard shortcuts:**\n- `t`: Set text entry mode to task, focus\n- `n`: Add note to selected task (if in tasks section)\n\n**Modify existing shortcuts:**\n- `i`: Set text entry mode to intention, focus\n- `w`: Set text entry mode to win, focus\n- `L`: Set text entry mode to log, focus\n\n**Handle text entry:**\n- `enter`: Submit based on mode, blur text entry\n- `esc`: Blur text entry, clear mode\n\n**Delegate to components:**\n- When textEntryBar is focused, delegate to it\n- When in Tasks section, delegate to taskList\n\n**Add message handlers:**\n```go\ncase tasksLoadedMsg:\n    m.tasks = msg.tasks\n    m.taskList = components.NewTaskList(msg.tasks)\n    return m, nil\n\ncase taskToggledMsg:\n    return m, m.loadTasks()\n\ncase taskAddedMsg:\n    return m, m.loadTasks()\n```\n\n## New Message Types\n\n```go\ntype tasksLoadedMsg struct {\n    tasks []journal.Task\n}\n\ntype taskToggledMsg struct{}\ntype taskAddedMsg struct{}\ntype noteAddedMsg struct{}\n```\n\n## New Helper Functions\n\n```go\nfunc (m *Model) loadTasks() tea.Cmd {\n    return func() tea.Msg {\n        tasks, err := m.taskService.GetAllTasks()\n        if err != nil {\n            return errMsg{err}\n        }\n        return tasksLoadedMsg{tasks}\n    }\n}\n\nfunc (m *Model) submitTextEntry() tea.Cmd {\n    value := m.textEntryBar.GetValue()\n    if value == \"\" {\n        return nil\n    }\n    \n    mode := m.textEntryBar.mode\n    \n    return func() tea.Msg {\n        var err error\n        switch mode {\n        case components.ModeTask:\n            err = m.taskService.AddTask(value)\n            if err != nil {\n                return errMsg{err}\n            }\n            return taskAddedMsg{}\n        case components.ModeIntention:\n            err = m.service.AddIntention(m.currentJournal, value)\n            // ... existing logic\n        // ... other modes\n        }\n    }\n}\n```\n\n## Acceptance Criteria\n\n- Model uses new components (TaskList, ScheduleView, TextEntryBar)\n- View() renders 40-40-18 layout\n- Keyboard shortcuts focus text entry bar\n- Text entry submits correctly based on mode\n- Tasks load and display\n- Schedule items load and display\n- Removed input mode logic\n- Proper message handling for tasks\n\n## Dependencies\n\nRequires: All UI components (Layout, TaskList, ScheduleView, TextEntryBar)\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 4, Step 5.1-5.5)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:49:20.221850015-05:00","updated_at":"2025-12-23T19:49:20.221850015-05:00","dependencies":[{"issue_id":"reckon-40n","depends_on_id":"reckon-jaq","type":"blocks","created_at":"2025-12-23T19:49:42.153852581-05:00","created_by":"daemon"},{"issue_id":"reckon-40n","depends_on_id":"reckon-ujt","type":"blocks","created_at":"2025-12-23T19:49:42.197948105-05:00","created_by":"daemon"},{"issue_id":"reckon-40n","depends_on_id":"reckon-8id","type":"blocks","created_at":"2025-12-23T19:49:42.243092603-05:00","created_by":"daemon"},{"issue_id":"reckon-40n","depends_on_id":"reckon-zx7","type":"blocks","created_at":"2025-12-23T19:49:42.288120014-05:00","created_by":"daemon"},{"issue_id":"reckon-40n","depends_on_id":"reckon-fcm","type":"blocks","created_at":"2025-12-23T19:49:42.328686036-05:00","created_by":"daemon"},{"issue_id":"reckon-40n","depends_on_id":"reckon-82m","type":"blocks","created_at":"2025-12-23T19:49:42.383409007-05:00","created_by":"daemon"}]}
{"id":"reckon-440","title":"Add task file storage methods","description":"Add file system operations for tasks.md.\n\n## File to Modify\n\n`internal/storage/filesystem.go`\n\n## Methods to Add\n\n1. `GetTasksPath() (string, error)`:\n   - Return path to tasks.md in reckon directory\n   - Pattern: `~/.reckon/tasks.md`\n   - Use existing helper for getting reckon directory\n\n2. `ReadTasksFile() (string, FileInfo, error)`:\n   - Read content from tasks.md\n   - Return content, file info (for last modified), and error\n   - Return empty string if file doesn't exist (not an error)\n\n3. `WriteTasksFile(content string) error`:\n   - Write content to tasks.md\n   - Create file if it doesn't exist\n   - Use atomic write if possible (write to temp, rename)\n\n## Implementation Details\n\n- Follow existing patterns from journal file operations\n- Use `os.UserHomeDir()` to get home directory\n- Handle file not existing gracefully (create on first write)\n- Ensure directory exists before writing\n\n## Acceptance Criteria\n\n- GetTasksPath returns correct path (~/.reckon/tasks.md)\n- ReadTasksFile reads existing file\n- ReadTasksFile returns empty content (no error) if file doesn't exist\n- WriteTasksFile creates file if needed\n- WriteTasksFile overwrites existing file\n\n## Dependencies\n\nNone (just file operations)\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 1, Step 2.4)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:45:57.302327655-05:00","updated_at":"2025-12-23T19:45:57.302327655-05:00"}
{"id":"reckon-4ay","title":"Wire up TaskService in main.go","description":"Wire up TaskService in application initialization.\n\n## File to Modify\n\n`cmd/rk/main.go` (or wherever TUI is initialized)\n\n## Changes\n\n**Create TaskService instance:**\n```go\n// After creating journal service...\ntaskRepo := journal.NewTaskRepository(db)\ntaskService := journal.NewTaskService(taskRepo, filesystem)\n```\n\n**Pass to TUI model:**\n```go\n// Modify NewModel call\nmodel := tui.NewModel(journalService, taskService)\n```\n\n**Update TUI NewModel signature:**\nIn `internal/tui/model.go`:\n```go\nfunc NewModel(service *journal.Service, taskService *journal.TaskService) *Model {\n    // ...\n    return \u0026Model{\n        service:     service,\n        taskService: taskService,\n        // ...\n    }\n}\n```\n\n## Implementation Details\n\n- TaskService requires TaskRepository and Filesystem\n- Same DB connection used for both services\n- Initialization order: DB → Filesystem → Repos → Services → TUI\n\n## Acceptance Criteria\n\n- TaskService properly initialized\n- Passed to TUI model\n- TUI can call taskService methods\n- No initialization errors\n\n## Dependencies\n\nRequires: TaskService, TaskRepository, TUI model with taskService field\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 5, Step 6.1)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:49:20.606271676-05:00","updated_at":"2025-12-23T19:49:20.606271676-05:00","dependencies":[{"issue_id":"reckon-4ay","depends_on_id":"reckon-fcm","type":"blocks","created_at":"2025-12-23T19:49:42.669218521-05:00","created_by":"daemon"},{"issue_id":"reckon-4ay","depends_on_id":"reckon-40n","type":"blocks","created_at":"2025-12-23T19:49:42.72207231-05:00","created_by":"daemon"}]}
{"id":"reckon-5q5","title":"Phase 4: Zettelkasten Notes","description":"Implement a knowledge base with searchable notes. Notes use wiki-style [[slug]] links and support full-text search via SQLite FTS5.\n\n**Requires Phase 1**: Uses parser, storage infrastructure. Independent of tasks.\n\n**Note File Format** (notes/\u003cslug\u003e.md):\n```markdown\n---\ntitle: Git interactive rebase workflow\ncreated: 2025-01-12\ntags: [git, workflow]\n---\n\nTo squash the last 3 commits:\n    git rebase -i HEAD~3\n\nChange 'pick' to 'squash' for commits to combine.\n\n## See Also\n- [[git-bisect-workflow]]\n- [[git-cherry-pick]]\n```\n\n**SQLite Additions**:\n```sql\nCREATE TABLE notes (slug TEXT PRIMARY KEY, title TEXT, created TEXT, file_path TEXT);\nCREATE TABLE note_tags (slug TEXT, tag TEXT, PRIMARY KEY (slug, tag));\nCREATE VIRTUAL TABLE notes_fts USING fts5(slug, title, content, tags);\n```\n\n**Features to Implement**:\n\n1. **Note Domain Model** (internal/note/)\n   - Note struct: slug, title, created, tags, content, links (extracted [[slug]] refs)\n   - NoteService: Create, GetBySlug, Search, ListByTag, ListAll\n\n2. **Note Parser/Writer** (internal/parser/)\n   - Parse frontmatter (title, created, tags)\n   - Extract [[slug]] links from content\n   - Slug generation from title (lowercase, hyphenated)\n\n3. **FTS5 Indexing** (internal/storage/)\n   - Index note content in FTS5 table on save/rebuild\n   - Search returns ranked results\n\n4. **Note Search Component** (internal/tui/components/note_search.go)\n   - Text input for search query\n   - Results list with title and snippet\n   - Enter to view note\n\n5. **Note View Component** (internal/tui/components/note_view.go)\n   - Display note content (markdown rendered or plain)\n   - [[slug]] links are navigable (Enter to follow)\n   - 'e' to edit in $EDITOR\n\n6. **Tag Browser** (internal/tui/components/tag_browser.go)\n   - List all tags with note counts\n   - Select tag to filter notes\n\n7. **Note Creation Flow**\n   - TUI: Ctrl+N in notes mode opens creation form\n   - CLI: rk note new \"title\" creates note, opens in $EDITOR\n\n8. **TUI Integration**\n   - New mode: Notes (switch with Ctrl+K or 'n' from main view)\n   - Notes mode shows: search bar, tag filter, note list, note preview\n\n9. **CLI Commands**:\n   - rk note new \"title\" - create note, output path, open in $EDITOR\n   - rk note search \"query\" - full-text search, output matching notes\n   - rk note list - list all notes (--tag filter)\n   - rk note show \u003cslug\u003e - output note content\n\n**Acceptance Criteria**:\n- Can create notes from TUI and CLI\n- Notes are stored as markdown in ~/.reckon/notes/\u003cslug\u003e.md\n- rk note search \"query\" returns FTS5 results\n- TUI has notes mode with search, tag filter, note list\n- [[slug]] links are detected and navigable in TUI\n- Tags are indexed and browsable\n- rk rebuild includes notes in FTS5 index","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:48:38.366620991-05:00","updated_at":"2025-12-22T16:48:38.366620991-05:00","dependencies":[{"issue_id":"reckon-5q5","depends_on_id":"reckon-a39","type":"blocks","created_at":"2025-12-22T16:49:06.731839147-05:00","created_by":"daemon"}]}
{"id":"reckon-7hf","title":"Test backward compatibility and create migration guide","description":"Test backward compatibility with existing journals and document migration.\n\n## Testing Tasks\n\n**1. Test with existing journals:**\n- Open journal files created before this change\n- Verify Intentions, Wins, Logs still parse and display\n- Verify no errors or data loss\n\n**2. Test adding Schedule to old journals:**\n- Open old journal\n- Add schedule item via TUI\n- Verify ## Schedule section added correctly\n- Verify file still readable\n\n**3. Test empty state:**\n- Start with no tasks.md\n- Add first task via TUI\n- Verify tasks.md created correctly\n\n**4. Test database migration:**\n- Verify new tables created automatically\n- No errors on first run with new schema\n\n**5. Test edge cases:**\n- Very long task text\n- Task with many notes\n- Empty schedule section\n- Journal with only some sections\n\n## Create Migration Guide\n\n**File to create:** `docs/migration-tui-redesign.md`\n\n**Content:**\n```markdown\n# TUI Redesign Migration Guide\n\n## What's New\n\n- New 40-40-18 layout (Logs | Tasks | Sidebar)\n- Tasks: General todo list with nested notes\n- Schedule: Upcoming items in daily journals\n- Always-visible text entry bar\n\n## For Existing Users\n\n### Automatic Changes\n\n- New database tables created automatically\n- Existing journals unchanged and fully compatible\n- No data migration needed\n\n### New Files\n\n- `~/.reckon/tasks.md` - Created on first task add\n\n### New Keyboard Shortcuts\n\n- `t` - Add task\n- `n` - Add note to selected task\n- `enter` - Expand/collapse task (in Tasks section)\n\n### Updated Sections\n\nDaily journals now support optional `## Schedule` section:\n\\```markdown\n## Schedule\n\n- 09:00 Morning standup\n- 14:00 Client meeting\n\\```\n\n## Rollback\n\nIf needed, you can roll back without data loss:\n- Old journal files remain valid\n- New tables are separate (won't affect old code)\n- Can delete `tasks.md` if desired\n```\n\n## Acceptance Criteria\n\n- Existing journals open without errors\n- Schedule section can be added to old journals\n- New database schema applies without manual intervention\n- tasks.md created on demand\n- Migration guide documented\n- Edge cases tested\n- No data loss scenarios\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 5, Step 6.3)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:49:21.263353227-05:00","updated_at":"2025-12-23T19:49:21.263353227-05:00","dependencies":[{"issue_id":"reckon-7hf","depends_on_id":"reckon-4ay","type":"blocks","created_at":"2025-12-23T19:49:42.827359803-05:00","created_by":"daemon"},{"issue_id":"reckon-7hf","depends_on_id":"reckon-95p","type":"blocks","created_at":"2025-12-23T19:49:42.881070621-05:00","created_by":"daemon"}]}
{"id":"reckon-82m","title":"Extend JournalService for schedule items","description":"Extend journal service to support schedule items.\n\n## File to Modify\n\n`internal/journal/service.go`\n\n## Methods to Add\n\n```go\n// AddScheduleItem adds a schedule item to the journal\nfunc (s *Service) AddScheduleItem(j *Journal, timeStr string, content string) error\n\n// DeleteScheduleItem removes a schedule item from the journal\nfunc (s *Service) DeleteScheduleItem(j *Journal, itemID string) error\n```\n\n## Method to Modify\n\n`GetByDate(date string) (*Journal, error)`:\n- Load schedule items from DB via repository\n- Populate j.ScheduleItems\n\n`save(j *Journal) error`:\n- Save schedule items to DB via repository\n\n## Implementation Details\n\n**AddScheduleItem:**\n1. Parse timeStr (HH:MM format, or empty)\n2. Create ScheduleItem with generated ID\n3. Set position = len(j.ScheduleItems)\n4. Append to j.ScheduleItems\n5. Call save()\n\n**DeleteScheduleItem:**\n1. Find item in j.ScheduleItems by ID\n2. Remove from slice\n3. Re-index positions\n4. Call save()\n\n**GetByDate modification:**\n- After loading journal, query schedule items from DB\n- Set j.ScheduleItems\n\n**save modification:**\n- After saving file, persist schedule items to DB\n\n## Acceptance Criteria\n\n- AddScheduleItem creates and persists schedule item\n- DeleteScheduleItem removes and updates positions\n- GetByDate loads schedule items from DB\n- save() persists schedule items to DB\n- Integration with existing save/load flow\n\n## Dependencies\n\nRequires: ScheduleItem model, journal parser/writer extensions, repository methods for schedule\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 2, Step 3.2)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:46:29.317097543-05:00","updated_at":"2025-12-23T19:46:29.317097543-05:00","dependencies":[{"issue_id":"reckon-82m","depends_on_id":"reckon-mpn","type":"blocks","created_at":"2025-12-23T19:49:41.764099934-05:00","created_by":"daemon"},{"issue_id":"reckon-82m","depends_on_id":"reckon-aww","type":"blocks","created_at":"2025-12-23T19:49:41.814528668-05:00","created_by":"daemon"}]}
{"id":"reckon-8id","title":"Create ScheduleView component","description":"Create ScheduleView Bubble Tea component for displaying schedule items.\n\n## File to Create\n\n`internal/tui/components/schedule_view.go`\n\n## Component Structure\n\n```go\ntype ScheduleView struct {\n    items  []journal.ScheduleItem\n    width  int\n    height int\n}\n\nfunc NewScheduleView(items []journal.ScheduleItem) *ScheduleView\nfunc (sv *ScheduleView) Update(msg tea.Msg) (*ScheduleView, tea.Cmd)\nfunc (sv *ScheduleView) View() string\nfunc (sv *ScheduleView) SetSize(width, height int)\nfunc (sv *ScheduleView) UpdateSchedule(items []journal.ScheduleItem)\n```\n\n## Rendering\n\n- Title: \"Schedule\" (styled with lipgloss)\n- Format: `HH:MM Content` or just `Content` (if no time)\n- Simple list (no interaction needed initially)\n- Truncate long content with \"...\" if needed\n- Show empty state: \"No schedule items\"\n\n## Implementation Details\n\n- Simpler than TaskList (no selection/interaction)\n- Sort items by time before rendering\n- Use lipgloss for styling (consistent with other components)\n- Handle items with and without time\n- Follow pattern from `internal/tui/components/wins_view.go`\n\n## Styling\n\n```go\nscheduleStyle = lipgloss.NewStyle().\n    Foreground(lipgloss.Color(\"39\")).\n    Bold(true)\n\nitemStyle = lipgloss.NewStyle().\n    Foreground(lipgloss.Color(\"252\"))\n```\n\n## Acceptance Criteria\n\n- Displays schedule items with time (HH:MM format)\n- Displays items without time\n- Shows title \"Schedule\"\n- Handles empty schedule\n- Truncates long text to fit width\n- Sorted by time\n\n## Dependencies\n\nRequires: ScheduleItem model\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 3, Step 4.2)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:47:16.121646485-05:00","updated_at":"2025-12-23T19:47:16.121646485-05:00","dependencies":[{"issue_id":"reckon-8id","depends_on_id":"reckon-e0f","type":"blocks","created_at":"2025-12-23T19:49:42.105679818-05:00","created_by":"daemon"}]}
{"id":"reckon-8ug","title":"TUI: Status bar hints are context-insensitive","description":"The status bar shows the same hints regardless of current section or mode.\n\nCurrent: All hints shown all the time\n  'q:quit tab:switch i:intention w:win L:log h/l:nav t:today ?:help enter:toggle'\n\nIssues:\n- enter:toggle only works in Intentions section, not Wins or Logs\n- Hints don't change based on focused section\n- Input mode shows separate prompt but could be integrated\n\nImprovements:\n1. Show section-specific hints based on focusedSection\n2. Update hints in input mode to show editing keys\n3. Consider showing section name in status bar\n\nExample for Intentions section:\n  'Intentions | q:quit tab:switch enter:toggle j/k:nav i:add h/l:day t:today'\n\nThis helps users understand context-specific actions.","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T19:27:13.560455554-05:00","updated_at":"2025-12-22T19:27:13.560455554-05:00"}
{"id":"reckon-90q","title":"TUI: Remove unused logInput field","description":"Model has an unused field that's never initialized or used.\n\nLocation: internal/tui/model.go:34\n\n\nThis was likely leftover from an earlier implementation approach. Should be removed to clean up the code.","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-22T18:53:21.96824436-05:00","updated_at":"2025-12-22T19:34:34.825145269-05:00","closed_at":"2025-12-22T19:34:34.825145269-05:00","close_reason":"Fixed: Removed unused inputText field, now using textInput throughout."}
{"id":"reckon-92t","title":"Phase 5: Periodic Review","description":"Surface stale tasks and prompt the user to triage them. Helps maintain a clean task list and prevents tasks from being forgotten.\n\n**Requires Phase 2**: Uses task infrastructure to query stale tasks.\n\n**Features to Implement**:\n\n1. **Stale Task Query** (internal/task/)\n   - FindStaleTasks(days int): tasks with no log entries in N days\n   - Default: 7 days for active, 30 days for waiting\n   - Exclude 'someday' tasks from stale detection\n\n2. **Review TUI Mode** (internal/tui/components/review.go)\n   - List of stale tasks with last activity date\n   - For each task, quick actions:\n     - 'd' - mark done\n     - 's' - move to someday\n     - 'w' - mark waiting (prompts for reason)\n     - 'n' - add note/update\n     - 'x' - delete task\n     - Space - skip to next\n   - Batch mode: review all stale tasks in sequence\n\n3. **Weekly Review Prompt**\n   - Track last_review_date in config/db\n   - On first launch of the week (Monday), show prompt: \"You have X stale tasks. Review now? (y/n)\"\n   - 'y' enters review mode, 'n' dismisses until next week\n\n4. **Review Summary**\n   - After review session, show summary: \"Reviewed X tasks: Y done, Z deferred, W deleted\"\n\n5. **CLI Commands**:\n   - rk review - launch review mode (or output stale tasks if not TTY)\n   - rk review --list - just list stale tasks without interactive mode\n\n**Acceptance Criteria**:\n- rk review shows tasks with no activity in 7+ days\n- Can mark tasks done/waiting/someday from review mode\n- Can delete tasks from review mode\n- Weekly prompt appears on first Monday launch\n- Review summary shows what was triaged\n- rk review --list outputs stale tasks for scripting","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:48:50.894281259-05:00","updated_at":"2025-12-22T16:48:50.894281259-05:00","dependencies":[{"issue_id":"reckon-92t","depends_on_id":"reckon-9cn","type":"blocks","created_at":"2025-12-22T16:49:06.988538091-05:00","created_by":"daemon"}]}
{"id":"reckon-95p","title":"Update help view and documentation for new TUI","description":"Update help view to reflect new keyboard shortcuts and layout.\n\n## File to Modify\n\n`internal/tui/model.go` (helpView() function)\n\n## New Help Text\n\n```\nHelp - Key Bindings:\n\nNavigation:\n  h, ←       Previous day\n  l, →       Next day\n  t          Jump to today\n  tab        Next section\n  shift+tab  Previous section\n  j, k       Navigate within section\n\nActions:\n  t          Add task\n  i          Add intention\n  w          Add win\n  L          Add log entry\n  n          Add note to selected task (Tasks section)\n  space      Toggle task/intention (Tasks/Intentions section)\n  enter      Expand/collapse task (Tasks section)\n\nText Entry:\n  enter      Submit entry\n  esc        Cancel entry\n  any key    Type character\n\nGeneral:\n  q, ctrl+c  Quit\n  ?          Toggle help\n\nSections:\n  - Logs: Activity log with timestamps\n  - Tasks: General todo list with collapsible notes\n  - Schedule: Upcoming items for the day\n  - Intentions: 1-3 focus tasks for today\n  - Wins: Daily accomplishments\n\nPress ? to exit help.\n```\n\n## Also Update\n\n- README.md: Update screenshots/description if present\n- AGENTS.md: No changes needed (workflow unchanged)\n\n## Acceptance Criteria\n\n- Help text shows all new shortcuts\n- Describes new sections (Tasks, Schedule)\n- Explains text entry bar usage\n- Accurate key bindings\n- Clear section descriptions\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 5)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:49:20.929976834-05:00","updated_at":"2025-12-23T19:49:20.929976834-05:00","dependencies":[{"issue_id":"reckon-95p","depends_on_id":"reckon-40n","type":"blocks","created_at":"2025-12-23T19:49:42.772986217-05:00","created_by":"daemon"}]}
{"id":"reckon-9cl","title":"TUI: Replace magic number with constant in section cycling","description":"Section cycling uses magic number 3 that's not obvious or maintainable.\n\nLocation: internal/tui/model.go:134\n\n\nShould either:\n1. Define constant: \n2. Calculate from actual sections\n3. Use an enum/iota-based approach\n\nMakes code more maintainable if sections are added/removed.","status":"closed","priority":4,"issue_type":"task","created_at":"2025-12-22T18:53:25.43575798-05:00","updated_at":"2025-12-22T19:34:35.125603476-05:00","closed_at":"2025-12-22T19:34:35.125603476-05:00","close_reason":"Fixed: Now using SectionCount constant instead of magic number 3."}
{"id":"reckon-9cn","title":"Phase 2: Task Management","description":"Add multi-day task tracking. Tasks are separate markdown files with their own log history. Log entries can be linked to tasks and appear in both the task file and daily journal.\n\n**Requires Phase 1**: Uses parser, storage, and TUI infrastructure from Phase 1.\n\n**Task File Format** (tasks/\u003cid\u003e.md):\n```markdown\n---\nid: abc123\ntitle: API refactor for v2 endpoints\ncreated: 2025-01-10\nstatus: active\ntags: [backend, api]\n---\n\n## Description\nRefactor the v2 endpoints to use the new middleware pattern.\n\n## Log\n\n### 2025-01-10\n- 14:00 Created task, outlined approach\n\n### 2025-01-14\n- 09:00 Resumed work\n```\n\n**Task Statuses**: active, done, waiting, someday\n\n**SQLite Additions**:\n```sql\nCREATE TABLE tasks (id TEXT PRIMARY KEY, title TEXT, status TEXT, created TEXT, file_path TEXT);\nCREATE TABLE task_tags (task_id TEXT, tag TEXT, PRIMARY KEY (task_id, tag));\nCREATE TABLE task_log_entries (id TEXT PRIMARY KEY, task_id TEXT, date TEXT, timestamp TEXT, content TEXT);\n```\n\n**Features to Implement**:\n\n1. **Task Domain Model** (internal/task/)\n   - Task struct with id, title, status, created, tags, description, log entries\n   - TaskService: Create, GetByID, List (filter by status/tags), UpdateStatus, AppendLog\n\n2. **Task Parser/Writer** (internal/parser/)\n   - Parse task frontmatter (id, title, created, status, tags array)\n   - Parse description section\n   - Parse log section (grouped by date)\n\n3. **Dual-Write Logic**\n   - When logging to a task, entry goes to BOTH:\n     - Task file under appropriate date header\n     - Daily journal with [task:id] prefix\n   - TaskService coordinates this\n\n4. **Task Picker Component** (internal/tui/components/task_picker.go)\n   - Fuzzy-searchable list of active tasks\n   - Used when starting work on a task or logging to specific task\n\n5. **Two-Pane TUI Layout**\n   - Left pane: daily journal (existing)\n   - Right pane: current task (when selected)\n   - Tab switches between panes\n   - Ctrl+T opens task picker\n\n6. **Task Creation Flow**\n   - From TUI: Ctrl+N opens task creation form (title, tags)\n   - From CLI: rk task new \"title\" --tags=backend,api\n   - Can also promote an intention to a task\n\n7. **CLI Commands**:\n   - rk task new \"title\" - create task, outputs task ID\n   - rk task list - list active tasks (--status, --tag filters)\n   - rk task show \u003cid\u003e - output task details\n   - rk task log \u003cid\u003e \"msg\" - append to task log (also adds to today's journal)\n   - rk task done \u003cid\u003e - mark task complete\n\n**Acceptance Criteria**:\n- Can create tasks from TUI and CLI\n- Task picker allows fuzzy search of active tasks\n- Two-pane view shows journal and current task\n- Logging to task writes to both task file and daily journal\n- rk task list shows active tasks\n- rk task log \u003cid\u003e \"msg\" works from CLI\n- Task status transitions work (active → done/waiting/someday)\n- Can filter tasks by tag","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-22T16:47:07.626775343-05:00","updated_at":"2025-12-22T16:47:07.626775343-05:00","dependencies":[{"issue_id":"reckon-9cn","depends_on_id":"reckon-a39","type":"blocks","created_at":"2025-12-22T16:49:06.147251564-05:00","created_by":"daemon"}]}
{"id":"reckon-9n6","title":"Create task file parser and writer","description":"Create parser and writer for tasks.md file with support for nested notes.\n\n## Files to Create\n\n1. `internal/journal/task_parser.go`:\n   - `ParseTasksFile(content string) ([]Task, error)` - Parse tasks.md content\n   - `WriteTasksFile(tasks []Task) string` - Serialize tasks to markdown\n   \n## File Format\n\n```markdown\n# Tasks\n\n- [ ] task-id-1 Task 1 text\n- [ ] task-id-2 Task 2 text\n  - note-id-1 Note for task 2\n  - note-id-2 Another note\n- [x] task-id-3 Completed task\n```\n\n## Implementation Details\n\n- Parse checkbox status: `[ ]` (open), `[x]` (done)\n- Support nested notes with 2-space indentation\n- Extract task ID from the line (embedded in text for now)\n- Generate IDs using xid (consistent with existing code)\n- Sort by position when writing\n- Follow existing parser patterns from `internal/journal/parser.go`\n\n## Acceptance Criteria\n\n- Parses tasks with checkboxes and status\n- Parses nested notes with 2-space indentation\n- Writes tasks with proper formatting and indentation\n- Handles empty tasks list\n- Handles tasks with no notes\n\n## Dependencies\n\nRequires: Task and TaskNote models from previous ticket\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 1, Step 2.1)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:43:46.317036065-05:00","updated_at":"2025-12-23T19:43:46.317036065-05:00","dependencies":[{"issue_id":"reckon-9n6","depends_on_id":"reckon-e0f","type":"blocks","created_at":"2025-12-23T19:49:41.441764884-05:00","created_by":"daemon"}]}
{"id":"reckon-a1y","title":"TUI: Inconsistent error handling in date navigation","description":"Date parsing errors in navigation functions are silently ignored.\n\nLocations:\n- internal/tui/model.go:240 (prevDay)\n- internal/tui/model.go:247 (nextDay)\n\nBoth functions use:\n  date, _ := time.Parse(...)\n\nIf m.currentDate is corrupted or invalid, these will fail silently and navigation will break in confusing ways.\n\nShould either:\n1. Return errors to be handled by caller\n2. Log the error\n3. Fall back to today's date\n\nRelated to reckon-re2 (general error handling improvements).","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T19:27:13.206070635-05:00","updated_at":"2025-12-22T19:27:13.206070635-05:00"}
{"id":"reckon-a39","title":"Phase 1: Daily Journal MVP","description":"Implement the core daily journaling system - the foundation of Reckon. This creates a TUI for viewing/editing daily journals and CLI commands for scripting.\n\n**Storage Model**:\n- Data directory: ~/.reckon/\n- Journal files: ~/.reckon/journal/YYYY-MM-DD.md\n- SQLite index: ~/.reckon/reckon.db\n- Markdown is source of truth; SQLite is rebuildable via rk rebuild\n\n**Journal File Format** (journal/2025-01-15.md):\n```markdown\n---\ndate: 2025-01-15\n---\n\n## Intentions\n- [ ] Open task (unchecked)\n- [x] Completed task (checked)\n- [\u003e] Carried from previous day\n\n## Wins\n- Something accomplished\n\n## Log\n- 09:00 Started day\n- 10:30 [meeting:standup] 30m\n- 14:00 [task:abc123] Working on feature\n```\n\n**SQLite Schema**:\n```sql\nCREATE TABLE journals (date TEXT PRIMARY KEY, file_path TEXT, last_modified INTEGER);\nCREATE TABLE intentions (id TEXT PRIMARY KEY, journal_date TEXT, text TEXT, status TEXT, carried_from TEXT, position INTEGER);\nCREATE TABLE log_entries (id TEXT PRIMARY KEY, journal_date TEXT, timestamp TEXT, content TEXT, task_id TEXT, entry_type TEXT, duration_minutes INTEGER, position INTEGER);\nCREATE TABLE wins (id TEXT PRIMARY KEY, journal_date TEXT, text TEXT, position INTEGER);\n```\n\n**Features to Implement**:\n\n1. **Project Setup**\n   - Initialize Go module, create directory structure per plan\n   - Dependencies: bubbletea, lipgloss, bubbles, cobra, goldmark, fsnotify, xid, modernc.org/sqlite\n\n2. **Config \u0026 Paths** (internal/config/)\n   - DataDir(), JournalDir(), DatabasePath() helpers\n   - Auto-create directories on first run\n\n3. **Domain Models** (internal/journal/)\n   - Journal, Intention (open/done/carried), LogEntry (log/meeting/break), Win\n   - ID generation using xid\n\n4. **Markdown Parser** (internal/parser/)\n   - Parse YAML frontmatter (date)\n   - Parse sections by H2 headers (Intentions, Wins, Log)\n   - Parse intention markers: [ ], [x], [\u003e]\n   - Parse log entries: timestamp, optional [meeting:name], [task:id], duration 30m\n\n5. **Markdown Writer** (internal/parser/)\n   - Serialize Journal back to markdown format\n   - Round-trip must preserve content\n\n6. **Storage Layer** (internal/storage/)\n   - Filesystem: read/write markdown files\n   - SQLite: connection with WAL mode, migrations, repository pattern\n\n7. **Journal Service** (internal/journal/service.go)\n   - GetToday(), GetByDate(date), AppendLog(content), AddIntention(text), ToggleIntention(id), AddWin(text)\n   - Dual-write: update markdown file AND SQLite\n   - Auto-carry: when opening a new day, copy open intentions from yesterday as [\u003e]\n\n8. **CLI Commands** (internal/cli/)\n   - rk log \"msg\" - append timestamped entry to today's log\n   - rk today - output today's journal to stdout (for LLM piping)\n   - rk week - output last 7 days to stdout\n   - rk rebuild - delete and regenerate SQLite from all markdown files\n\n9. **TUI** (internal/tui/)\n   - Main model with state: currentDate, currentJournal, focusedSection\n   - Components: IntentionList (navigable, Enter to toggle), WinsView, LogView, LogInput (text input)\n   - Statusbar with keybinding hints\n   - Key bindings: Tab (cycle sections), i (add intention), l (add log), w (add win), h/Left (prev day), l/Right (next day, max today), t (jump to today), ? (help), q (quit)\n   - Past days are read-only (no editing)\n\n10. **File Watcher** (internal/sync/)\n    - Watch ~/.reckon/journal/ for external changes\n    - Debounce 100ms, re-index changed files to SQLite\n    - Notify TUI to reload if current journal changed\n\n**Acceptance Criteria**:\n- rk launches TUI showing today's journal (creates empty if none exists)\n- Can navigate sections with Tab, add intentions with 'i', log entries with 'l', wins with 'w'\n- Can toggle intentions done with Enter\n- Can navigate to previous days with h/l (read-only)\n- rk log \"test\" appends to today's journal from CLI\n- rk today outputs journal content to stdout\n- rk rebuild regenerates SQLite from markdown files\n- External file edits are detected and TUI refreshes\n- Opening a new day auto-carries open intentions with [\u003e] marker\n\n**Key Files**:\n- cmd/rk/main.go - entry point\n- internal/journal/service.go - core business logic\n- internal/parser/journal_parser.go - markdown parsing\n- internal/tui/model.go - TUI state management","status":"in_progress","priority":1,"issue_type":"feature","created_at":"2025-12-22T16:47:05.957692427-05:00","updated_at":"2025-12-22T16:52:47.433215284-05:00","dependencies":[{"issue_id":"reckon-a39","depends_on_id":"reckon-l7d","type":"blocks","created_at":"2025-12-22T17:17:43.596222613-05:00","created_by":"daemon"},{"issue_id":"reckon-a39","depends_on_id":"reckon-3e9","type":"blocks","created_at":"2025-12-22T17:17:43.638904395-05:00","created_by":"daemon"}]}
{"id":"reckon-add","title":"TUI: Implement help mode or remove hint from status bar","description":"Status bar shows help hint but help mode is not implemented.\n\nLocation: internal/tui/model.go:145-147\n\nThe question mark key currently does nothing, but the status bar advertises it.\n\nOptions:\n1. Implement help overlay showing all keybindings\n2. Remove the help hint from status bar\n\nEither way, the current state confuses users who press question mark expecting help.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T18:53:43.877771907-05:00","updated_at":"2025-12-22T19:42:38.182449664-05:00","closed_at":"2025-12-22T19:42:38.182449664-05:00","close_reason":"Closed"}
{"id":"reckon-awc","title":"TUI: Fix state mutation bug in submitInput","description":"State reset happens inside the tea.Cmd function instead of in model update, causing potential race conditions.\n\nLocation: internal/tui/model.go:290-293\n\n\n\nThe state changes should happen in the Update() function, not in the command. This violates Bubble Tea's architecture and could cause state corruption.","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-22T18:53:02.329065842-05:00","updated_at":"2025-12-22T19:34:34.186455204-05:00","closed_at":"2025-12-22T19:34:34.186455204-05:00","close_reason":"Fixed: State mutation has been properly moved to Update function. Also completed full migration to bubbles/textinput component, removing hybrid state that would have caused input bugs."}
{"id":"reckon-aww","title":"Extend journal writer for Schedule section","description":"Extend journal writer to output ## Schedule section.\n\n## File to Modify\n\n`internal/journal/writer.go`\n\n## Changes\n\nAdd Schedule section between frontmatter and Intentions (insert after line ~16):\n\n```go\n// Write Schedule section\nsb.WriteString(\"## Schedule\\n\\n\")\nif len(j.ScheduleItems) \u003e 0 {\n    sortedSchedule := make([]ScheduleItem, len(j.ScheduleItems))\n    copy(sortedSchedule, j.ScheduleItems)\n    sort.Slice(sortedSchedule, func(i, j int) bool {\n        return sortedSchedule[i].Position \u003c sortedSchedule[j].Position\n    })\n    \n    for _, item := range sortedSchedule {\n        if !item.Time.IsZero() {\n            timeStr := item.Time.Format(\"15:04\")\n            sb.WriteString(fmt.Sprintf(\"- %s %s\\n\", timeStr, item.Content))\n        } else {\n            sb.WriteString(fmt.Sprintf(\"- %s\\n\", item.Content))\n        }\n    }\n}\nsb.WriteString(\"\\n\")\n```\n\n## Format\n\n```markdown\n## Schedule\n\n- 09:00 Morning standup\n- 14:00 Client meeting\n- Review PR\n\n## Intentions\n...\n```\n\n## Implementation Details\n\n- Sort by position before writing\n- Format time as HH:MM (15:04)\n- Omit time if Time.IsZero()\n- Follow existing patterns (see Intentions/Wins/Log sections)\n- Include section even if empty (with blank line)\n\n## Acceptance Criteria\n\n- Writes ## Schedule section before Intentions\n- Formats time as HH:MM when present\n- Omits time when not set\n- Sorts by position\n- Handles empty schedule list\n\n## Dependencies\n\nRequires: ScheduleItem model and journal parser extension\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 1, Step 2.3)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:45:56.859539502-05:00","updated_at":"2025-12-23T19:45:56.859539502-05:00","dependencies":[{"issue_id":"reckon-aww","depends_on_id":"reckon-mpn","type":"blocks","created_at":"2025-12-23T19:49:41.534559055-05:00","created_by":"daemon"}]}
{"id":"reckon-csz","title":"TUI Redesign: Work-Focused Daylog View","description":"Redesign the TUI from 3-column equal layout to work-focused 4-pane layout:\n- Left (40%): Logs\n- Center (40%): Tasks with collapsible notes\n- Right (18%): Stacked Schedule/Intentions/Wins\n\nNew features:\n- Tasks: General todo list with nested notes (global tasks.md file)\n- Schedule: Upcoming items in daily journals (new ## Schedule section)\n- Text entry bar: Always visible at bottom (replaces modal input)\n\nUX decisions:\n- Text entry always visible with context-aware prompt\n- Completed tasks shown with strikethrough\n- Keys (t/i/w/L) focus text entry bar\n\nKeep Bubble Tea framework. Maintain backward compatibility.\n\nDesign reference: docs/daylog_view_sketch_2025-12-23_19-26.png\nImplementation plan: ~/.claude/plans/recursive-strolling-treehouse.md","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-23T19:42:56.156816028-05:00","updated_at":"2025-12-23T19:42:56.156816028-05:00","dependencies":[{"issue_id":"reckon-csz","depends_on_id":"reckon-7hf","type":"blocks","created_at":"2025-12-23T19:49:42.937957968-05:00","created_by":"daemon"}]}
{"id":"reckon-e0f","title":"Add Task, TaskNote, ScheduleItem models and DB schema","description":"Add new data models to support tasks and schedule items.\n\n## Files to Modify\n\n1. `internal/journal/models.go`:\n   - Add `Task` struct: ID, Text, Status (TaskStatus), Notes ([]TaskNote), Position, CreatedAt\n   - Add `TaskNote` struct: ID, Text, Position\n   - Add `ScheduleItem` struct: ID, Time (time.Time), Content, Position\n   - Add `TaskStatus` enum: open, done, archived\n   - Add constructor functions: NewTask, NewTaskNote, NewScheduleItem\n   - Extend `Journal` struct: Add `ScheduleItems []ScheduleItem` field\n\n2. `internal/storage/database.go`:\n   - Add `tasks` table schema: id (PK), text, status, position, created_at\n   - Add `task_notes` table schema: id (PK), task_id (FK), text, position\n   - Add `schedule_items` table schema: id (PK), journal_date (FK), time, content, position\n   - Add indices for performance\n\n## Acceptance Criteria\n\n- Task, TaskNote, ScheduleItem structs defined with all fields\n- TaskStatus enum with open/done/archived values\n- Journal struct includes ScheduleItems field\n- Database schema includes all three new tables with proper foreign keys\n- Constructor functions implemented for all new types\n\n## Context\n\nThis is the foundation for the TUI redesign. Tasks are global (stored in tasks.md), while schedule items are per-journal.\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 1, Step 1.1-1.3)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:43:45.949909205-05:00","updated_at":"2025-12-23T19:43:45.949909205-05:00"}
{"id":"reckon-eg7","title":"TUI: Implement weighted multi-section vertical split view with borders","description":"Replace tabbed interface with vertical panes: Intentions (25%) | Wins (25%) | Logs (50%) with borders between sections. This allows viewing multiple entries from all categories simultaneously, addressing the 'one at a time' display issue.","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-22T20:15:06.269898711-05:00","updated_at":"2025-12-22T20:15:52.863085031-05:00","closed_at":"2025-12-22T20:15:52.863085031-05:00","close_reason":"Closed"}
{"id":"reckon-eps","title":"TUI: Implement multi-section split view","description":"Currently only one section (Intentions/Wins/Logs) is visible at a time. User must tab between them.\n\nWould be more useful to see all sections simultaneously in a split-pane layout.\n\nSuggested layout:\n\n\nThis is a bigger UX change - may want user feedback first.","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T18:53:15.105609805-05:00","updated_at":"2025-12-22T18:53:15.105609805-05:00"}
{"id":"reckon-fcm","title":"Create TaskService for task management","description":"Create service layer for task business logic.\n\n## File to Create\n\n`internal/journal/task_service.go`\n\n## Methods to Implement\n\n```go\ntype TaskService struct {\n    repo       *TaskRepository\n    filesystem *storage.Filesystem\n    parser     *TaskParser // or use functions directly\n}\n\nfunc NewTaskService(repo *TaskRepository, fs *storage.Filesystem) *TaskService\n\n// GetAllTasks loads tasks from file and DB (file is source of truth)\nfunc (s *TaskService) GetAllTasks() ([]Task, error)\n\n// AddTask creates a new task\nfunc (s *TaskService) AddTask(text string) error\n\n// ToggleTask toggles task status (open \u003c-\u003e done)\nfunc (s *TaskService) ToggleTask(taskID string) error\n\n// AddTaskNote adds a note to a task\nfunc (s *TaskService) AddTaskNote(taskID, noteText string) error\n\n// DeleteTaskNote removes a note from a task\nfunc (s *TaskService) DeleteTaskNote(taskID, noteID string) error\n\n// save (private) persists tasks to file and DB\nfunc (s *TaskService) save(tasks []Task) error\n```\n\n## Implementation Flow\n\n**GetAllTasks:**\n1. Read tasks.md via filesystem.ReadTasksFile()\n2. Parse content via ParseTasksFile()\n3. Return tasks\n\n**AddTask:**\n1. Load all tasks\n2. Create new Task with generated ID, position = len(tasks)\n3. Append to list\n4. save()\n\n**ToggleTask:**\n1. Load all tasks\n2. Find task by ID\n3. Toggle status (open → done, done → open)\n4. save()\n\n**save (private):**\n1. Write to file: WriteTasksFile() + filesystem.WriteTasksFile()\n2. Write to DB: repo.SaveTasks() (for indexing/querying)\n3. Both must succeed (consider transaction)\n\n## Implementation Details\n\n- File is source of truth, DB is index/cache\n- Always load from file, save to both\n- Use xid for generating IDs (consistent with rest of codebase)\n- Position based on array index\n\n## Acceptance Criteria\n\n- GetAllTasks loads from file and returns parsed tasks\n- AddTask creates task with generated ID and saves\n- ToggleTask flips status and persists\n- AddTaskNote adds note to correct task\n- save() writes to both file and DB\n\n## Dependencies\n\nRequires: TaskRepository, task parser, file storage methods\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 2, Step 3.1)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:46:28.973211094-05:00","updated_at":"2025-12-23T19:46:28.973211094-05:00","dependencies":[{"issue_id":"reckon-fcm","depends_on_id":"reckon-0e5","type":"blocks","created_at":"2025-12-23T19:49:41.619258416-05:00","created_by":"daemon"},{"issue_id":"reckon-fcm","depends_on_id":"reckon-9n6","type":"blocks","created_at":"2025-12-23T19:49:41.663695107-05:00","created_by":"daemon"},{"issue_id":"reckon-fcm","depends_on_id":"reckon-440","type":"blocks","created_at":"2025-12-23T19:49:41.716188743-05:00","created_by":"daemon"}]}
{"id":"reckon-hwo","title":"TUI: Add minimum terminal size validation","description":"Components receive size updates but don't validate minimum dimensions.\n\nIf terminal is too small, the UI may break or render incorrectly.\n\nShould:\n1. Define minimum usable dimensions (e.g., 80x24)\n2. Check on WindowSizeMsg\n3. Show 'Terminal too small' message if below minimum\n4. Gracefully handle resize events\n\nLocations: internal/tui/model.go:72-87","status":"open","priority":3,"issue_type":"task","created_at":"2025-12-22T18:53:27.040093904-05:00","updated_at":"2025-12-22T18:53:27.040093904-05:00"}
{"id":"reckon-jaq","title":"Create Layout manager for pane dimensions","description":"Create layout manager to calculate pane dimensions for 40-40-18 split.\n\n## File to Create\n\n`internal/tui/layout.go`\n\n## Types to Define\n\n```go\ntype PaneDimensions struct {\n    // Left pane (Logs)\n    LogsWidth  int\n    LogsHeight int\n    \n    // Center pane (Tasks)\n    TasksWidth  int\n    TasksHeight int\n    \n    // Right sidebar (total)\n    RightWidth  int\n    RightHeight int\n    \n    // Right sidebar (stacked components)\n    ScheduleHeight    int  // ~30% of right height\n    IntentionsHeight  int  // ~35% of right height\n    WinsHeight        int  // ~35% of right height\n    \n    // Bottom bars\n    TextEntryHeight int  // Fixed: 3 lines\n    StatusHeight    int  // Fixed: 1 line\n}\n```\n\n## Function to Implement\n\n```go\n// CalculatePaneDimensions computes pane sizes based on terminal dimensions\nfunc CalculatePaneDimensions(termWidth, termHeight int) PaneDimensions\n```\n\n## Calculation Logic\n\n```\nAvailable height = termHeight - textEntryHeight(3) - statusHeight(1)\nPane height = available height\n\nLeft width = termWidth * 0.40\nCenter width = termWidth * 0.40\nRight width = termWidth - left - center (remaining ~18%)\n\nRight sidebar vertical split:\n- Schedule: rightHeight * 0.30\n- Intentions: rightHeight * 0.35\n- Wins: rightHeight * 0.35\n```\n\n## Implementation Details\n\n- Handle minimum sizes (don't allow negative dimensions)\n- Round widths appropriately\n- Ensure sum of widths equals termWidth\n- Ensure sum of right sidebar heights equals rightHeight\n\n## Acceptance Criteria\n\n- Returns correct 40-40-18 split for various terminal sizes\n- Right sidebar properly divided into 30-35-35 vertically\n- Handles edge cases (very small terminals)\n- Sum of widths = termWidth\n- Text entry and status bars have fixed heights\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 3, Step 4.4)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:47:15.49382489-05:00","updated_at":"2025-12-23T19:47:15.49382489-05:00"}
{"id":"reckon-k3h","title":"TUI: Add deletion and editing for entries","description":"Currently users can only add intentions/wins/logs, not delete or edit them.\n\nMissing functionality:\n- Delete intentions (d key?)\n- Edit intention text  \n- Delete wins\n- Edit wins\n- Delete log entries\n- Edit log entries\n\nThis is important for fixing typos or removing accidental entries.\n\nConsider keybindings:\n- d: delete selected item (with confirmation)\n- e: edit selected item\n- or use vim-style dd for delete","status":"open","priority":4,"issue_type":"feature","created_at":"2025-12-22T18:53:28.306539005-05:00","updated_at":"2025-12-22T18:53:28.306539005-05:00"}
{"id":"reckon-l7d","title":"Phase 1.9: Build TUI for journal viewing and editing","description":"Implement the interactive TUI using Bubble Tea for viewing and editing daily journals.\n\n**Features**:\n- Main model with state: currentDate, currentJournal, focusedSection\n- Components: IntentionList (navigable, Enter to toggle), WinsView, LogView, LogInput\n- Statusbar with keybinding hints\n- Key bindings:\n  - Tab: cycle sections\n  - i: add intention\n  - l: add log entry  \n  - w: add win\n  - h/Left: prev day (read-only for past)\n  - l/Right: next day (max today)\n  - t: jump to today\n  - ?: help\n  - q: quit\n\n**Files**:\n- internal/tui/model.go - main TUI state\n- internal/tui/components/ - individual components\n- Update cmd/rk/main.go to launch TUI by default","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T17:17:32.642850579-05:00","updated_at":"2025-12-22T18:21:06.065014288-05:00","closed_at":"2025-12-22T18:21:06.065014288-05:00","close_reason":"Closed"}
{"id":"reckon-mpn","title":"Extend journal parser for Schedule section","description":"Extend journal parser to handle new ## Schedule section.\n\n## File to Modify\n\n`internal/journal/parser.go`\n\n## Changes\n\n1. Add `SectionSchedule` to Section enum (line ~44-51)\n2. Update section header matching in ParseJournal (line ~88-101):\n   - Add case for \"schedule\" → SectionSchedule\n3. Add parseScheduleItem function:\n   - Pattern: `- HH:MM Content` OR `- Content` (time optional)\n   - Return *ScheduleItem with ID, Time, Content, Position\n   - Use existing time parsing helper (parseTime)\n4. Add schedule parsing in main loop (line ~109-128):\n   - case SectionSchedule: parse schedule items\n\n## Format Examples\n\n```markdown\n## Schedule\n\n- 09:00 Morning standup\n- 14:00 Client meeting\n- Review PR (no time)\n```\n\n## Implementation Details\n\n- Time is optional (may be empty)\n- Follow existing parsing patterns (see parseIntention, parseLogEntry)\n- Handle empty Schedule section gracefully\n- Use xid for IDs (consistent with rest of codebase)\n\n## Acceptance Criteria\n\n- Parses ## Schedule section header\n- Parses schedule items with time (HH:MM format)\n- Parses schedule items without time\n- Handles empty Schedule section\n- Backward compatible: journals without Schedule section still parse\n\n## Dependencies\n\nRequires: ScheduleItem model from models ticket\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 1, Step 2.2)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:43:46.721829762-05:00","updated_at":"2025-12-23T19:43:46.721829762-05:00","dependencies":[{"issue_id":"reckon-mpn","depends_on_id":"reckon-e0f","type":"blocks","created_at":"2025-12-23T19:49:41.485883279-05:00","created_by":"daemon"}]}
{"id":"reckon-nxa","title":"TUI: Add empty state messages for sections","description":"When sections are empty, users see blank screens with no guidance.\n\nShould show helpful messages like:\n- Intentions: 'No intentions yet - press i to add one'\n- Wins: 'No wins yet - press w to add one'  \n- Logs: 'No log entries yet - press L to add one'\n\nThis helps new users understand how to interact with the app.\n\nLocations:\n- internal/tui/components/intention_list.go\n- internal/tui/components/wins_view.go\n- internal/tui/components/log_view.go","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-22T18:53:15.606800377-05:00","updated_at":"2025-12-23T16:53:36.10283095-05:00","closed_at":"2025-12-23T16:53:36.10283095-05:00","close_reason":"Closed"}
{"id":"reckon-re2","title":"TUI: Errors are silently swallowed - no user feedback","description":"When operations fail, errors are completely ignored with no feedback to user.\n\nLocation: internal/tui/model.go:99-101\n\nUser has no way to know when:\n- Journal fails to load\n- Intention toggle fails\n- Adding intentions/wins/logs fails\n\nShould add error display to model and show in View at bottom of screen or as a toast notification.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-22T18:53:43.565190335-05:00","updated_at":"2025-12-22T19:38:05.520793004-05:00","closed_at":"2025-12-22T19:38:05.520793004-05:00","close_reason":"Closed"}
{"id":"reckon-ujt","title":"Create TaskList component with collapse/expand","description":"Create TaskList Bubble Tea component with collapsible notes.\n\n## File to Create\n\n`internal/tui/components/task_list.go`\n\n## Component Structure\n\n```go\ntype TaskItem struct {\n    task     journal.Task\n    isNote   bool\n    noteID   string\n    taskID   string  // parent task ID for notes\n}\n\ntype TaskDelegate struct {\n    collapsedMap map[string]bool  // taskID -\u003e isCollapsed\n}\n\ntype TaskList struct {\n    list         list.Model\n    collapsedMap map[string]bool\n}\n\nfunc NewTaskList(tasks []journal.Task) *TaskList\nfunc (tl *TaskList) Update(msg tea.Msg) (*TaskList, tea.Cmd)\nfunc (tl *TaskList) View() string\nfunc (tl *TaskList) SetSize(width, height int)\nfunc (tl *TaskList) SelectedTask() *journal.Task\nfunc (tl *TaskList) UpdateTasks(tasks []journal.Task)\n```\n\n## Rendering Logic\n\n- Render task: `[ ] Task text` or `[x] Task text` (strikethrough if done)\n- Render notes: `  - Note text` (2-space indent)\n- Only show notes if task is not collapsed\n- Expand/collapse indicator: `▼` (expanded) or `▶` (collapsed)\n\n## Keyboard Handling\n\n- j/k: Navigate up/down (delegate to list.Model)\n- space: Toggle task status (return custom message)\n- enter: Toggle expand/collapse (update collapsedMap)\n\n## Implementation Details\n\n- Use Bubble Tea's `list.Model` with custom `TaskDelegate`\n- Convert tasks to list items (task + notes as separate items)\n- Filter notes based on collapsed state\n- Follow pattern from `internal/tui/components/intention_list.go`\n- Styling: Use lipgloss (consistent with other components)\n\n## Acceptance Criteria\n\n- Displays tasks with checkbox status\n- Shows/hides notes based on collapsed state\n- Space toggles task status (emits message)\n- Enter expands/collapses task\n- Handles tasks with no notes\n- Handles empty task list\n- Proper indentation for notes (2 spaces)\n- Strikethrough for completed tasks\n\n## Dependencies\n\nRequires: Task/TaskNote models\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 3, Step 4.1)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:47:15.850043832-05:00","updated_at":"2025-12-23T19:47:15.850043832-05:00","dependencies":[{"issue_id":"reckon-ujt","depends_on_id":"reckon-e0f","type":"blocks","created_at":"2025-12-23T19:49:42.057113443-05:00","created_by":"daemon"}]}
{"id":"reckon-wi4","title":"TUI: Replace primitive input handling with bubbles/textinput","description":"Current input handling is manual character-by-character string building with no cursor movement, text selection, or mid-string editing. Should use bubbles/textinput component.\n\nLocation: internal/tui/model.go:104-126\n\nIssues:\n- No cursor movement (left/right arrows)\n- No text selection\n- Backspace only deletes from end\n- No copy/paste support\n\nShould replace with bubbles/textinput for proper editing experience.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-22T18:41:05.856849246-05:00","updated_at":"2025-12-22T19:34:34.511737619-05:00","closed_at":"2025-12-22T19:34:34.511737619-05:00","close_reason":"Fixed: Fully migrated to bubbles/textinput.Model with proper cursor movement, text editing, and selection support."}
{"id":"reckon-zx7","title":"Create TextEntryBar component","description":"Create TextEntryBar Bubble Tea component for always-visible input.\n\n## File to Create\n\n`internal/tui/components/text_entry_bar.go`\n\n## Component Structure\n\n```go\ntype EntryMode string\n\nconst (\n    ModeInactive  EntryMode = \"\"\n    ModeTask      EntryMode = \"task\"\n    ModeIntention EntryMode = \"intention\"\n    ModeWin       EntryMode = \"win\"\n    ModeLog       EntryMode = \"log\"\n)\n\ntype TextEntryBar struct {\n    textInput textinput.Model\n    mode      EntryMode\n    width     int\n}\n\nfunc NewTextEntryBar() *TextEntryBar\nfunc (teb *TextEntryBar) Update(msg tea.Msg) (*TextEntryBar, tea.Cmd)\nfunc (teb *TextEntryBar) View() string\nfunc (teb *TextEntryBar) SetWidth(width int)\nfunc (teb *TextEntryBar) SetMode(mode EntryMode)\nfunc (teb *TextEntryBar) GetValue() string\nfunc (teb *TextEntryBar) Clear()\nfunc (teb *TextEntryBar) Focus() tea.Cmd\nfunc (teb *TextEntryBar) Blur()\nfunc (teb *TextEntryBar) IsFocused() bool\n```\n\n## Rendering\n\n**Inactive state:**\n```\n\u003e Press t (task), i (intention), w (win), or L (log) to add entry\n```\n\n**Active state (example for task mode):**\n```\n\u003e Add task: [user input here_]\n```\n\n## Prompt by Mode\n\n- task: \"Add task: \"\n- intention: \"Add intention: \"\n- win: \"Add win: \"\n- log: \"Add log entry: \"\n- inactive: \"Press t (task), i (intention), w (win), or L (log) to add entry\"\n\n## Implementation Details\n\n- Use Bubble Tea's `textinput.Model` (from bubbles package)\n- Always visible (render in all states)\n- Change prompt based on mode\n- Width adjusts to terminal width\n- Use lipgloss for styling (border, colors)\n\n## Keyboard Handling\n\n- Delegate to textinput.Model when focused\n- Parent model handles enter (submit) and esc (cancel/blur)\n\n## Styling\n\n```go\nactiveStyle = lipgloss.NewStyle().\n    BorderStyle(lipgloss.NormalBorder()).\n    BorderForeground(lipgloss.Color(\"39\")).\n    Padding(0, 1)\n\ninactiveStyle = lipgloss.NewStyle().\n    BorderStyle(lipgloss.NormalBorder()).\n    BorderForeground(lipgloss.Color(\"240\")).\n    Padding(0, 1).\n    Foreground(lipgloss.Color(\"240\"))\n```\n\n## Acceptance Criteria\n\n- Always visible (shows in all states)\n- Prompt changes based on mode\n- Accepts text input when focused\n- Blurs on ESC\n- Clear() resets input value\n- SetMode() changes prompt\n- Proper styling for active/inactive states\n\n## Dependencies\n\nRequires: bubbles/textinput package (already in use)\n\nReference: ~/.claude/plans/recursive-strolling-treehouse.md (Phase 3, Step 4.3)","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-23T19:48:19.897869478-05:00","updated_at":"2025-12-23T19:48:19.897869478-05:00"}
