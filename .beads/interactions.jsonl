{"id":"reckon-1l8","title":"Phase 3: Time Tracking","description":"Track time spent on meetings, breaks, and optionally tasks. Calculate daily time summaries.\n\n**Requires Phase 2**: Uses task infrastructure for task-level time tracking.\n\n**Time Entry Formats** (in log):\n```\n- 10:30 [meeting:standup] 30m       # meeting with duration\n- 12:00 [break] 45m                  # break with duration\n- 14:00 [task:abc123] Started work   # task entry (duration calculated from next entry or end of day)\n```\n\n**Features to Implement**:\n\n1. **Duration Parsing**\n   - Extend log entry parser to extract Xm or Xh duration\n   - Store in duration_minutes field\n\n2. **Time Calculation Service** (internal/time/)\n   - CalculateDaySummary(date): aggregate time by category\n   - For tasks without explicit duration, calculate from timestamps\n   - Categories: meetings, breaks, tasks (by task), untracked\n\n3. **Daily Summary Component** (internal/tui/components/summary.go)\n   - Shows time breakdown at bottom of journal view\n   - Toggle with 's' key\n   - Format: \"Meetings: 1h30m | Tasks: 4h15m | Breaks: 45m | Untracked: 1h30m\"\n\n4. **Optional Start/Stop Timer**\n   - rk start \u003ctask-id\u003e - log \"Started work on [task]\"\n   - rk stop - log \"Stopped\" (duration auto-calculated)\n   - TUI: Ctrl+S to start/stop timer on current task\n\n5. **CLI Commands**:\n   - rk summary - output today's time breakdown\n   - rk summary --week - output week's time breakdown\n   - rk start \u003ctask-id\u003e - start timer on task\n   - rk stop - stop current timer\n\n**Acceptance Criteria**:\n- Log entries with 30m duration are parsed and stored\n- [meeting:name] Xm entries are categorized as meetings\n- [break] Xm entries are categorized as breaks\n- rk summary outputs time breakdown for today\n- TUI shows time summary (toggle with 's')\n- Task time calculated from log entry timestamps\n- Start/stop timer commands work","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-22T16:48:37.245472509-05:00","updated_at":"2025-12-22T16:48:37.245472509-05:00","dependencies":[{"issue_id":"reckon-1l8","depends_on_id":"reckon-9cn","type":"blocks","created_at":"2025-12-22T16:49:06.430378979-05:00","created_by":"daemon"}]}
{"id":"reckon-5q5","title":"Phase 4: Zettelkasten Notes","description":"Implement a knowledge base with searchable notes. Notes use wiki-style [[slug]] links and support full-text search via SQLite FTS5.\n\n**Requires Phase 1**: Uses parser, storage infrastructure. Independent of tasks.\n\n**Note File Format** (notes/\u003cslug\u003e.md):\n```markdown\n---\ntitle: Git interactive rebase workflow\ncreated: 2025-01-12\ntags: [git, workflow]\n---\n\nTo squash the last 3 commits:\n    git rebase -i HEAD~3\n\nChange 'pick' to 'squash' for commits to combine.\n\n## See Also\n- [[git-bisect-workflow]]\n- [[git-cherry-pick]]\n```\n\n**SQLite Additions**:\n```sql\nCREATE TABLE notes (slug TEXT PRIMARY KEY, title TEXT, created TEXT, file_path TEXT);\nCREATE TABLE note_tags (slug TEXT, tag TEXT, PRIMARY KEY (slug, tag));\nCREATE VIRTUAL TABLE notes_fts USING fts5(slug, title, content, tags);\n```\n\n**Features to Implement**:\n\n1. **Note Domain Model** (internal/note/)\n   - Note struct: slug, title, created, tags, content, links (extracted [[slug]] refs)\n   - NoteService: Create, GetBySlug, Search, ListByTag, ListAll\n\n2. **Note Parser/Writer** (internal/parser/)\n   - Parse frontmatter (title, created, tags)\n   - Extract [[slug]] links from content\n   - Slug generation from title (lowercase, hyphenated)\n\n3. **FTS5 Indexing** (internal/storage/)\n   - Index note content in FTS5 table on save/rebuild\n   - Search returns ranked results\n\n4. **Note Search Component** (internal/tui/components/note_search.go)\n   - Text input for search query\n   - Results list with title and snippet\n   - Enter to view note\n\n5. **Note View Component** (internal/tui/components/note_view.go)\n   - Display note content (markdown rendered or plain)\n   - [[slug]] links are navigable (Enter to follow)\n   - 'e' to edit in $EDITOR\n\n6. **Tag Browser** (internal/tui/components/tag_browser.go)\n   - List all tags with note counts\n   - Select tag to filter notes\n\n7. **Note Creation Flow**\n   - TUI: Ctrl+N in notes mode opens creation form\n   - CLI: rk note new \"title\" creates note, opens in $EDITOR\n\n8. **TUI Integration**\n   - New mode: Notes (switch with Ctrl+K or 'n' from main view)\n   - Notes mode shows: search bar, tag filter, note list, note preview\n\n9. **CLI Commands**:\n   - rk note new \"title\" - create note, output path, open in $EDITOR\n   - rk note search \"query\" - full-text search, output matching notes\n   - rk note list - list all notes (--tag filter)\n   - rk note show \u003cslug\u003e - output note content\n\n**Acceptance Criteria**:\n- Can create notes from TUI and CLI\n- Notes are stored as markdown in ~/.reckon/notes/\u003cslug\u003e.md\n- rk note search \"query\" returns FTS5 results\n- TUI has notes mode with search, tag filter, note list\n- [[slug]] links are detected and navigable in TUI\n- Tags are indexed and browsable\n- rk rebuild includes notes in FTS5 index","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:48:38.366620991-05:00","updated_at":"2025-12-22T16:48:38.366620991-05:00","dependencies":[{"issue_id":"reckon-5q5","depends_on_id":"reckon-a39","type":"blocks","created_at":"2025-12-22T16:49:06.731839147-05:00","created_by":"daemon"}]}
{"id":"reckon-92t","title":"Phase 5: Periodic Review","description":"Surface stale tasks and prompt the user to triage them. Helps maintain a clean task list and prevents tasks from being forgotten.\n\n**Requires Phase 2**: Uses task infrastructure to query stale tasks.\n\n**Features to Implement**:\n\n1. **Stale Task Query** (internal/task/)\n   - FindStaleTasks(days int): tasks with no log entries in N days\n   - Default: 7 days for active, 30 days for waiting\n   - Exclude 'someday' tasks from stale detection\n\n2. **Review TUI Mode** (internal/tui/components/review.go)\n   - List of stale tasks with last activity date\n   - For each task, quick actions:\n     - 'd' - mark done\n     - 's' - move to someday\n     - 'w' - mark waiting (prompts for reason)\n     - 'n' - add note/update\n     - 'x' - delete task\n     - Space - skip to next\n   - Batch mode: review all stale tasks in sequence\n\n3. **Weekly Review Prompt**\n   - Track last_review_date in config/db\n   - On first launch of the week (Monday), show prompt: \"You have X stale tasks. Review now? (y/n)\"\n   - 'y' enters review mode, 'n' dismisses until next week\n\n4. **Review Summary**\n   - After review session, show summary: \"Reviewed X tasks: Y done, Z deferred, W deleted\"\n\n5. **CLI Commands**:\n   - rk review - launch review mode (or output stale tasks if not TTY)\n   - rk review --list - just list stale tasks without interactive mode\n\n**Acceptance Criteria**:\n- rk review shows tasks with no activity in 7+ days\n- Can mark tasks done/waiting/someday from review mode\n- Can delete tasks from review mode\n- Weekly prompt appears on first Monday launch\n- Review summary shows what was triaged\n- rk review --list outputs stale tasks for scripting","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-22T16:48:50.894281259-05:00","updated_at":"2025-12-22T16:48:50.894281259-05:00","dependencies":[{"issue_id":"reckon-92t","depends_on_id":"reckon-9cn","type":"blocks","created_at":"2025-12-22T16:49:06.988538091-05:00","created_by":"daemon"}]}
{"id":"reckon-9cn","title":"Phase 2: Task Management","description":"Add multi-day task tracking. Tasks are separate markdown files with their own log history. Log entries can be linked to tasks and appear in both the task file and daily journal.\n\n**Requires Phase 1**: Uses parser, storage, and TUI infrastructure from Phase 1.\n\n**Task File Format** (tasks/\u003cid\u003e.md):\n```markdown\n---\nid: abc123\ntitle: API refactor for v2 endpoints\ncreated: 2025-01-10\nstatus: active\ntags: [backend, api]\n---\n\n## Description\nRefactor the v2 endpoints to use the new middleware pattern.\n\n## Log\n\n### 2025-01-10\n- 14:00 Created task, outlined approach\n\n### 2025-01-14\n- 09:00 Resumed work\n```\n\n**Task Statuses**: active, done, waiting, someday\n\n**SQLite Additions**:\n```sql\nCREATE TABLE tasks (id TEXT PRIMARY KEY, title TEXT, status TEXT, created TEXT, file_path TEXT);\nCREATE TABLE task_tags (task_id TEXT, tag TEXT, PRIMARY KEY (task_id, tag));\nCREATE TABLE task_log_entries (id TEXT PRIMARY KEY, task_id TEXT, date TEXT, timestamp TEXT, content TEXT);\n```\n\n**Features to Implement**:\n\n1. **Task Domain Model** (internal/task/)\n   - Task struct with id, title, status, created, tags, description, log entries\n   - TaskService: Create, GetByID, List (filter by status/tags), UpdateStatus, AppendLog\n\n2. **Task Parser/Writer** (internal/parser/)\n   - Parse task frontmatter (id, title, created, status, tags array)\n   - Parse description section\n   - Parse log section (grouped by date)\n\n3. **Dual-Write Logic**\n   - When logging to a task, entry goes to BOTH:\n     - Task file under appropriate date header\n     - Daily journal with [task:id] prefix\n   - TaskService coordinates this\n\n4. **Task Picker Component** (internal/tui/components/task_picker.go)\n   - Fuzzy-searchable list of active tasks\n   - Used when starting work on a task or logging to specific task\n\n5. **Two-Pane TUI Layout**\n   - Left pane: daily journal (existing)\n   - Right pane: current task (when selected)\n   - Tab switches between panes\n   - Ctrl+T opens task picker\n\n6. **Task Creation Flow**\n   - From TUI: Ctrl+N opens task creation form (title, tags)\n   - From CLI: rk task new \"title\" --tags=backend,api\n   - Can also promote an intention to a task\n\n7. **CLI Commands**:\n   - rk task new \"title\" - create task, outputs task ID\n   - rk task list - list active tasks (--status, --tag filters)\n   - rk task show \u003cid\u003e - output task details\n   - rk task log \u003cid\u003e \"msg\" - append to task log (also adds to today's journal)\n   - rk task done \u003cid\u003e - mark task complete\n\n**Acceptance Criteria**:\n- Can create tasks from TUI and CLI\n- Task picker allows fuzzy search of active tasks\n- Two-pane view shows journal and current task\n- Logging to task writes to both task file and daily journal\n- rk task list shows active tasks\n- rk task log \u003cid\u003e \"msg\" works from CLI\n- Task status transitions work (active â†’ done/waiting/someday)\n- Can filter tasks by tag","status":"open","priority":2,"issue_type":"feature","created_at":"2025-12-22T16:47:07.626775343-05:00","updated_at":"2025-12-22T16:47:07.626775343-05:00","dependencies":[{"issue_id":"reckon-9cn","depends_on_id":"reckon-a39","type":"blocks","created_at":"2025-12-22T16:49:06.147251564-05:00","created_by":"daemon"}]}
{"id":"reckon-a39","title":"Phase 1: Daily Journal MVP","description":"Implement the core daily journaling system - the foundation of Reckon. This creates a TUI for viewing/editing daily journals and CLI commands for scripting.\n\n**Storage Model**:\n- Data directory: ~/.reckon/\n- Journal files: ~/.reckon/journal/YYYY-MM-DD.md\n- SQLite index: ~/.reckon/reckon.db\n- Markdown is source of truth; SQLite is rebuildable via rk rebuild\n\n**Journal File Format** (journal/2025-01-15.md):\n```markdown\n---\ndate: 2025-01-15\n---\n\n## Intentions\n- [ ] Open task (unchecked)\n- [x] Completed task (checked)\n- [\u003e] Carried from previous day\n\n## Wins\n- Something accomplished\n\n## Log\n- 09:00 Started day\n- 10:30 [meeting:standup] 30m\n- 14:00 [task:abc123] Working on feature\n```\n\n**SQLite Schema**:\n```sql\nCREATE TABLE journals (date TEXT PRIMARY KEY, file_path TEXT, last_modified INTEGER);\nCREATE TABLE intentions (id TEXT PRIMARY KEY, journal_date TEXT, text TEXT, status TEXT, carried_from TEXT, position INTEGER);\nCREATE TABLE log_entries (id TEXT PRIMARY KEY, journal_date TEXT, timestamp TEXT, content TEXT, task_id TEXT, entry_type TEXT, duration_minutes INTEGER, position INTEGER);\nCREATE TABLE wins (id TEXT PRIMARY KEY, journal_date TEXT, text TEXT, position INTEGER);\n```\n\n**Features to Implement**:\n\n1. **Project Setup**\n   - Initialize Go module, create directory structure per plan\n   - Dependencies: bubbletea, lipgloss, bubbles, cobra, goldmark, fsnotify, xid, modernc.org/sqlite\n\n2. **Config \u0026 Paths** (internal/config/)\n   - DataDir(), JournalDir(), DatabasePath() helpers\n   - Auto-create directories on first run\n\n3. **Domain Models** (internal/journal/)\n   - Journal, Intention (open/done/carried), LogEntry (log/meeting/break), Win\n   - ID generation using xid\n\n4. **Markdown Parser** (internal/parser/)\n   - Parse YAML frontmatter (date)\n   - Parse sections by H2 headers (Intentions, Wins, Log)\n   - Parse intention markers: [ ], [x], [\u003e]\n   - Parse log entries: timestamp, optional [meeting:name], [task:id], duration 30m\n\n5. **Markdown Writer** (internal/parser/)\n   - Serialize Journal back to markdown format\n   - Round-trip must preserve content\n\n6. **Storage Layer** (internal/storage/)\n   - Filesystem: read/write markdown files\n   - SQLite: connection with WAL mode, migrations, repository pattern\n\n7. **Journal Service** (internal/journal/service.go)\n   - GetToday(), GetByDate(date), AppendLog(content), AddIntention(text), ToggleIntention(id), AddWin(text)\n   - Dual-write: update markdown file AND SQLite\n   - Auto-carry: when opening a new day, copy open intentions from yesterday as [\u003e]\n\n8. **CLI Commands** (internal/cli/)\n   - rk log \"msg\" - append timestamped entry to today's log\n   - rk today - output today's journal to stdout (for LLM piping)\n   - rk week - output last 7 days to stdout\n   - rk rebuild - delete and regenerate SQLite from all markdown files\n\n9. **TUI** (internal/tui/)\n   - Main model with state: currentDate, currentJournal, focusedSection\n   - Components: IntentionList (navigable, Enter to toggle), WinsView, LogView, LogInput (text input)\n   - Statusbar with keybinding hints\n   - Key bindings: Tab (cycle sections), i (add intention), l (add log), w (add win), h/Left (prev day), l/Right (next day, max today), t (jump to today), ? (help), q (quit)\n   - Past days are read-only (no editing)\n\n10. **File Watcher** (internal/sync/)\n    - Watch ~/.reckon/journal/ for external changes\n    - Debounce 100ms, re-index changed files to SQLite\n    - Notify TUI to reload if current journal changed\n\n**Acceptance Criteria**:\n- rk launches TUI showing today's journal (creates empty if none exists)\n- Can navigate sections with Tab, add intentions with 'i', log entries with 'l', wins with 'w'\n- Can toggle intentions done with Enter\n- Can navigate to previous days with h/l (read-only)\n- rk log \"test\" appends to today's journal from CLI\n- rk today outputs journal content to stdout\n- rk rebuild regenerates SQLite from markdown files\n- External file edits are detected and TUI refreshes\n- Opening a new day auto-carries open intentions with [\u003e] marker\n\n**Key Files**:\n- cmd/rk/main.go - entry point\n- internal/journal/service.go - core business logic\n- internal/parser/journal_parser.go - markdown parsing\n- internal/tui/model.go - TUI state management","status":"open","priority":1,"issue_type":"feature","created_at":"2025-12-22T16:47:05.957692427-05:00","updated_at":"2025-12-22T16:47:05.957692427-05:00"}
